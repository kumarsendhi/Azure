var fm=function(n){"use strict";function r(t,r){var u,f;return n(t.target).closest(".feedback_trigger").length===1?u=n(t.target).closest(".feedback_trigger")[0].className:n(t.target).closest(".feedback_content").length===1?u=n(t.target).closest(".feedback_content")[0].className:(r===undefined&&(r="left-top"),u=r),u.indexOf("left-top")!==-1?f="left-top":u.indexOf("left-bottom")!==-1?f="left-bottom":u.indexOf("right-top")!==-1?f="right-top":u.indexOf("right-bottom")!==-1&&(f="right-bottom"),i[f]}function o(i,r){var e={},o={},u,f;e.marginLeft="+=380px";o.marginLeft="-=380px";fm.getFmOptions(i,r).position.indexOf("right-")!==-1&&(e.marginRight="+=380px",o.marginRight="-=380px");u=n(i.target).closest(".feedback_trigger");u.length===1?f=u.next():(f=n(i.target).closest(".feedback_content"),u=f.prev());(f.length===0||u.length===0)&&(r===undefined&&(r="left-top"),f=n("."+r).closest(".feedback_content"),u=f.prev());u.hasClass("feedback_trigger_closed")?t===!0?(u.removeClass("feedback_trigger_closed"),f.removeClass("feedback_content_closed")):u.add(f).animate(e,150,function(){u.removeClass("feedback_trigger_closed");f.removeClass("feedback_content_closed")}):(u.addClass("feedback_trigger_closed"),f.addClass("feedback_content_closed"),t===!1&&u.add(f).animate(o,150))}function u(r){if((n(".feedback_content").length!==1||!n(".feedback_content").hasClass("feedback_content_closed"))&&n(r.target).closest(".feedback_content").length!==1){var u={},f;u.marginLeft="-=380px";for(f in i)i.hasOwnProperty(f)&&(f.indexOf("right-")!==-1&&(u.marginRight="-=380px"),n(".feedback_trigger").addClass("feedback_trigger_closed"),n(".feedback_content").addClass("feedback_content_closed"),t===!1&&n(".feedback_trigger , .feedback_content").animate(u,150))}}function s(n){var t=n.lastIndexOf("@");return t<n.length-1&&t>0&&n.indexOf("@@")===-1&&n.length>2}function h(t,i){var u=n(t.target).closest(".feedback_content"),f=r(t,i);return f.name_required===!0&&u.find(".feedback_name").val()===""||f.email_required===!0&&u.find(".feedback_email").val()===""||f.email_required===!0&&s(u.find(".feedback_email").val())===!1||f.message_required===!0&&u.find(".feedback_message").val()===""||f.radio_button_list_required===!0&&u.find("input[name=feedback_radio]:checked").val()===undefined?!1:!0}function c(t,i){var u=n("."+i+" [pattern]"),f=!0,r;if(u.length>0)for(r=0;r<u.length;r++)if(f=!u[r].validity.patternMismatch,f===!1)break;return f}function l(t,i){var u=n("."+i+" [required]"),r=!0;return u.length>0&&(r=h(t,i)),r}function a(){var t=n().jquery.split(".");if(t[0]=+t[0],t[1]=+t[1],t[0]>=1&&t[1]>=7)n(document).on("click",document,function(n){u(n)});else n(document).delegate("body",document,function(n){u(n)})}function v(t){var h="",c="",o="",l="",v="",y="",p="",w="",i="",b="",r=" fm_clean ",u="",f="",s="",e="",k=t.name_pattern===""?"":'pattern="'+t.name_pattern+'"',d=t.name_required?"required":"",g=t.email_required?"required":"",nt=t.message_required?"required":"",tt=t.radio_button_list_required?"required":"",it=t.name_required&&t.show_asterisk_for_required?'<span class="required_asterisk">*<\/span>':"",rt=t.email_required&&t.show_asterisk_for_required?'<span class="required_asterisk">*<\/span>':"",ut=t.message_required&&t.show_asterisk_for_required?'<span class="required_asterisk">*<\/span>':"",ft=t.radio_button_list_required&&t.show_asterisk_for_required?'<span class="required_asterisk">*<\/span>':"";t.bootstrap===!0&&(f=" fm_bootstrap ",s=" btn btn-primary ",e=" hero-unit ",r="",u="");t.jQueryUI===!0&&(u=" fm_jquery ",o=" ui-widget-header ui-corner-all ui-helper-clearfix ",l=" ui-dialog ui-widget ui-widget-content ui-corner-all ",v=" ui-dialog-titlebar ",y=" ui-dialog-title ",r="",f="",e="",s="");t.show_radio_button_list===!0&&(i='<li><div class="radio_button_list_title_wrapper"><div class="radio_button_list_title">'+t.radio_button_list_title+ft+'<\/div><\/div><div class="radio_button_list_wrapper">',i+='    <div class="radio_button_wrapper">',i+='        <input value="1" type="radio" name="feedback_radio" class="feedback_radio_1" '+tt+"/>",i+='        <label for="feedback_radio_1">'+t.radio_button_list_labels[0]+"<\/label>",i+="    <\/div>",i+='    <div class="radio_button_wrapper">',i+='        <input value="2" type="radio" name="feedback_radio" class="feedback_radio_2"/>',i+='        <label for="feedback_radio_2">'+t.radio_button_list_labels[1]+"<\/label>",i+="    <\/div>",i+='    <div class="radio_button_wrapper">',i+='        <input value="3" type="radio" name="feedback_radio" class="feedback_radio_3"/>',i+='        <label for="feedback_radio_3">'+t.radio_button_list_labels[2]+"<\/label>",i+="    <\/div>",i+='    <div class="radio_button_wrapper">',i+='        <input value="4" type="radio" name="feedback_radio" class="feedback_radio_4"/>',i+='        <label for="feedback_radio_4">'+t.radio_button_list_labels[3]+"<\/label>",i+="    <\/div>",i+='    <div class="radio_button_wrapper">',i+='        <input value="5" type="radio" name="feedback_radio" class="feedback_radio_5"/>',i+='        <label for="feedback_radio_5">'+t.radio_button_list_labels[4]+"<\/label>",i+="    <\/div>",i+="<\/div><\/li>",b=" radio_button_list_present");t.show_email===!0&&(p='<li>\t<label for="feedback_email">'+t.email_label+"<\/label> "+rt+' <input type="email" class="feedback_email" '+g+' placeholder="'+t.email_placeholder+'"><\/input> <\/li>',w=" email_present");t.show_form===!0&&(h='<form class="feedback_me_form"><ul><li>\t<label for="feedback_name">'+t.name_label+"<\/label> "+it+' <input type="text" class="feedback_name" '+d+' placeholder="'+t.name_placeholder+'" '+k+"><\/input> <\/li>"+p+'<li>\t<label for="feedback_message">'+t.message_label+"<\/label> "+ut+' <textarea rows="5" class="feedback_message" '+nt+' placeholder="'+t.message_placeholder+'"><\/textarea> <\/li>'+i+'<li>\t<button type="submit" onclick="fm.sendFeedback(event,\''+t.position+'\');" class="feedback_submit '+s+'">'+t.submit_label+"<\/button> <\/li><\/ul><\/form>");t.iframe_url!==undefined&&(c='<iframe name="feedback_me_frame" class="feedback_me_frame" frameborder="0" src="'+t.iframe_url+'"><\/iframe>');n("body").append('<div onclick="fm.stopPropagation(event);fm.triggerAction(event);" class="newsletterTopMargin feedback_trigger feedback_trigger_closed '+t.position+o+r+u+f+e+'"><span class="feedback_trigger_text">'+t.trigger_label+"<\/span><\/div>");n("body").append('<div class="newsletterContentTopMargin feedback_content feedback_content_closed '+t.position+w+b+l+r+u+f+e+'"><div class="feedback_title '+o+v+'"><span class="'+y+'">'+t.title_label+"<\/span><\/div>"+h+c+t.custom_html+"<\/div>");t.jQueryUI===!0&&n(".feedback_submit").button({icons:{primary:"ui-icon-mail-closed"}});t.close_on_click_outside===!0&&a();n(".feedback_me_form").submit(function(n){n.preventDefault()})}function f(n){n.stopPropagation!==undefined?n.stopPropagation():n.cancelBubble=!0}function e(n,i,r){var u={};u.marginLeft="-=380px";n.position.indexOf("right-")!==-1&&(u.marginRight="-=380px");t===!0?(i.addClass("feedback_trigger_closed"),r.addClass("feedback_content_closed")):i.add(r).animate(u,150,function(){i.addClass("feedback_trigger_closed")})}function y(t){var i=n(t.target).closest(".feedback_content");i.find(".feedback_name").val("");i.find(".feedback_message").val("");i.find(".feedback_email").val("");i.find(".feedback_me_form input[name=feedback_radio]").prop("checked",!1)}function p(t,i){var a=l(t,i),v=c(t,i),s,h,o,u=r(t,i);if(a===!1||v===!1){f(t);return}o=n(t.target).closest(".feedback_content");h=n(t.target).closest(".feedback_content").prev();u.delayed_close===!0&&o.find(".feedback_submit").text(u.delayed_options.sending);s={name:o.find(".feedback_name").val(),message:o.find(".feedback_message").val(),email:o.find(".feedback_email").val(),radio_list_value:o.find(".feedback_me_form input[name=feedback_radio]:checked").val()};s=n.extend(u.custom_params,s);n.ajax({type:"POST",url:u.feedback_url,data:s,beforeSend:function(){u.delayed_close===!1&&e(u,h,o)},success:function(){var i="";fm.clearInputs(t);u.delayed_close===!0&&(u.delayed_options.success_color!==undefined&&(i=' style="background-color:'+u.delayed_options.success_color+'" '),o.find(".feedback_submit").text(u.submit_label),e(u,h,o),n("body").append("<div "+i+' class="feedback-delayed-dlg success" onclick="fm.stopPropagation(event);"><span class="feedback-dlg-close" onclick="fm.closeFeedbackDelayedDlg();">X<\/span><span class="feedback-sucess-message"><span class="feedback-sucess-fail-message-inner"><span>'+u.delayed_options.send_success+"<\/span><\/span><\/span><\/div>"),setTimeout(function(){n(".feedback-delayed-dlg").fadeOut(function(){n(this).remove()})},u.delayed_options.delay_success_milliseconds))},error:function(){var t="";u.delayed_close===!0?(u.delayed_options.fail_color!==undefined&&(t=' style="background-color:'+u.delayed_options.fail_color+'" '),o.find(".feedback_submit").text(u.submit_label),n("body").append("<div "+t+' class="feedback-delayed-dlg fail" onclick="fm.stopPropagation(event);"><span class="feedback-dlg-close" onclick="fm.closeFeedbackDelayedDlg();">X<\/span><span class="feedback-fail-message"><span class="feedback-sucess-fail-message-inner"><span>'+u.delayed_options.send_fail+"<\/span><\/span><\/span><\/div>"),setTimeout(function(){n(".feedback-delayed-dlg").fadeOut(function(){n(this).remove()})},u.delayed_options.delay_fail_milliseconds)):console.log("Failed to send feedback (please double check your feedback_url parameter)")}})}function w(){n(".feedback-delayed-dlg").fadeOut()}function b(){var f=document.body||document.documentElement,u=f.style,n="transition",r,i;if(typeof u[n]=="string"){t=!0;return}for(r=["Moz","Webkit","Khtml","O","ms"],n=n.charAt(0).toUpperCase()+n.substr(1),i=0;i<r.length;i++)if(typeof u[r[i]+n]=="string"){t=!0;return}t=!1;return}function k(t){var u={feedback_url:"",position:"left-top",jQueryUI:!1,bootstrap:!1,show_email:!1,show_radio_button_list:!1,close_on_click_outside:!0,name_label:"Name",email_label:"Email",message_label:"Message",radio_button_list_labels:["1","2","3","4","5"],radio_button_list_title:"How would you rate my site?",name_placeholder:"",email_placeholder:"",message_placeholder:"",name_pattern:"",name_required:!1,email_required:!1,message_required:!1,radio_button_list_required:!1,show_asterisk_for_required:!1,submit_label:"Send",title_label:"Feedback",trigger_label:"Feedback",custom_params:{},iframe_url:undefined,show_form:!0,custom_html:"",delayed_close:!0,delayed_options:{delay_success_milliseconds:2e3,delay_fail_milliseconds:2e3,sending:"Sending...",send_fail:"Sending failed.",send_success:"Feedack sent.",fail_color:undefined,success_color:undefined}},r,f;f=n.extend(u.delayed_options,t.delayed_options);r=n.extend(u,t);r.delayed_options=f;i[r.position]=r;v(r);b(r)}var i={},t=!1;return{init:k,sendFeedback:p,getFmOptions:r,triggerAction:o,stopPropagation:f,clearInputs:y,closeFeedbackDelayedDlg:w}}(jQuery)